From bcddca9d7e7642a3e76f6d2b48bb7cd2a5fcc111 Mon Sep 17 00:00:00 2001
From: "Yew, Chang Ching" <chang.ching.yew@intel.com>
Date: Mon, 17 Apr 2023 10:49:27 +0800
Subject: [PATCH 1/2] avdevice/kahawai: Add kahawai output device

Signed-off-by: Yew, Chang Ching <chang.ching.yew@intel.com>
---
 configure                                | 1 +
 libavdevice/Makefile                     | 3 ++-
 libavdevice/alldevices.c                 | 1 +
 libavdevice/{kahawai.c => kahawai_dec.c} | 0
 4 files changed, 4 insertions(+), 1 deletion(-)
 rename libavdevice/{kahawai.c => kahawai_dec.c} (100%)

diff --git a/configure b/configure
index de1959d89c..09ad8aab1c 100755
--- a/configure
+++ b/configure
@@ -3425,6 +3425,7 @@ iec61883_indev_deps="libiec61883"
 jack_indev_deps="libjack"
 jack_indev_deps_any="sem_timedwait dispatch_dispatch_h"
 kahawai_indev_deps="mtl"
+kahawai_outdev_deps="mtl"
 kmsgrab_indev_deps="libdrm"
 lavfi_indev_deps="avfilter"
 libcdio_indev_deps="libcdio"
diff --git a/libavdevice/Makefile b/libavdevice/Makefile
index a8b82f1d8c..421a787f5d 100644
--- a/libavdevice/Makefile
+++ b/libavdevice/Makefile
@@ -31,7 +31,8 @@ OBJS-$(CONFIG_FBDEV_OUTDEV)              += fbdev_enc.o \
 OBJS-$(CONFIG_GDIGRAB_INDEV)             += gdigrab.o
 OBJS-$(CONFIG_IEC61883_INDEV)            += iec61883.o
 OBJS-$(CONFIG_JACK_INDEV)                += jack.o timefilter.o
-OBJS-$(CONFIG_KAHAWAI_INDEV)             += kahawai_dec.o
+OBJS-$(CONFIG_KAHAWAI_INDEV)             += kahawai_common.o kahawai_dec.o
+OBJS-$(CONFIG_KAHAWAI_OUTDEV)            += kahawai_common.o kahawai_enc.o
 OBJS-$(CONFIG_KMSGRAB_INDEV)             += kmsgrab.o
 OBJS-$(CONFIG_LAVFI_INDEV)               += lavfi.o
 OBJS-$(CONFIG_OPENAL_INDEV)              += openal-dec.o
diff --git a/libavdevice/alldevices.c b/libavdevice/alldevices.c
index 9072779ea1..b8baf822fd 100644
--- a/libavdevice/alldevices.c
+++ b/libavdevice/alldevices.c
@@ -40,6 +40,7 @@ extern AVInputFormat  ff_gdigrab_demuxer;
 extern AVInputFormat  ff_iec61883_demuxer;
 extern AVInputFormat  ff_jack_demuxer;
 extern AVInputFormat  ff_kahawai_demuxer;
+extern AVOutputFormat ff_kahawai_muxer;
 extern AVInputFormat  ff_kmsgrab_demuxer;
 extern AVInputFormat  ff_lavfi_demuxer;
 extern AVInputFormat  ff_openal_demuxer;
-- 
2.25.1

